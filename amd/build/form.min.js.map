{"version":3,"sources":["../src/form.js"],"names":["define","STR","JS","plugin","str","init","get_strings","done","s","i","deselectall","selectall","apply","exportsettings","importsettings","fieldset","document","querySelector","querySelectorAll","forEach","elm","x","matches","parentNode","previousElementSibling","style","width","div","createElement","node","name","id","replace","classList","remove","add","appendChild","input","setAttribute","addEventListener","onchange_selectall","attachEvent","label","innerText","paddingRight","insertBefore","nextSibling","checked","checkbox"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * blocks/ungraded_activities.php\n *\n * @package    blocks\n * @subpackage ungraded_activities\n * @copyright  2021 Gordon Bateson (gordon.bateson@gmail.com)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      Moodle 2.9\n */\n\ndefine([\"core/str\"], function(STR) {\n\n    /** @alias module:block_ungraded_activities/view */\n    var JS = {};\n\n    // cache the plugin name and string cache\n    JS.plugin = \"block_ungraded_activities\";\n    JS.str = {};\n\n    /*\n     * initialize this AMD module\n     */\n    JS.init = function() {\n\n        STR.get_strings([\n            {\"key\": \"deselectall\",    \"component\": \"moodle\"},\n            {\"key\": \"selectall\",      \"component\": \"moodle\"},\n            {\"key\": \"apply\",          \"component\": JS.plugin},\n            {\"key\": \"exportsettings\", \"component\": JS.plugin},\n            {\"key\": \"importsettings\", \"component\": JS.plugin}\n        ]).done(function(s) {\n            var i = 0;\n            JS.str.deselectall    = s[i++];\n            JS.str.selectall      = s[i++];\n            JS.str.apply          = s[i++];\n            JS.str.exportsettings = s[i++];\n            JS.str.importsettings = s[i++];\n\n            var fieldset = document.querySelector(\"#id_activities\");\n            if (fieldset) {\n                fieldset.querySelectorAll(\"[id$=showactivities] select\").forEach(function(elm){\n                    var x = elm;\n                    while (x && ! x.matches(\".fitem\")) {\n                        x = x.parentNode;\n                    }\n                    while (x && ! x.matches(\"div:empty\")) {\n                        x = x.previousElementSibling;\n                    }\n                    if (x) {\n                        x.style.width = \"4px\";\n                    }\n                });\n            }\n\n            var elm = document.querySelector(\"select[name^=config_mycourses]\");\n            if (elm) {\n                var fieldsets = \"#id_title, #id_activities, #id_users, #id_date, #id_applyselectedvalues\";\n                document.querySelectorAll(fieldsets).forEach(function(fieldset){\n                    fieldset.querySelectorAll(\".row.fitem .col-md-9\").forEach(function(elm, i){\n\n                        var div = document.createElement(\"DIV\");\n\n                        var node = null;\n\n                        // get name of parent element e.g. \"fitem_id_description\"\n                        // and remove everything up to final underscore \"_\".\n                        var name = elm.parentNode.id;\n                        name = name.replace(new RegExp(\"^.+_\"), \"\");\n\n                        if (name == \"description\") {\n                            elm.classList.remove(\"col-md-9\");\n                            elm.classList.add(\"col-md-7\");\n\n                            div.classList.add(\"d-none\");\n                            div.classList.add(\"d-md-block\");\n                            div.classList.add(\"col-md-2\");\n                            div.classList.add(\"px-0\");\n                            div.classList.add(\"text-right\");\n\n                            node = elm.querySelector(\".exportsettings\");\n                            if (node) {\n                                div.appendChild(node);\n                            }\n\n                            node = elm.querySelector(\".importsettings\");\n                            if (node) {\n                                div.appendChild(node);\n                            }\n\n                            var input = document.createElement(\"INPUT\");\n                            input.setAttribute(\"type\", \"checkbox\");\n                            input.setAttribute(\"name\", \"select_all\");\n                            input.setAttribute(\"id\", \"id_select_all\");\n                            input.classList.add(\"ml-2\");\n                            if (input.addEventListener) {\n                                input.addEventListener(\"change\", JS.onchange_selectall, false);\n                            } else if (input.attachEvent) {\n                                input.attachEvent(\"onchange\", JS.onchange_selectall);\n                            }\n\n                            var label = document.createElement(\"LABEL\");\n                            label.setAttribute(\"for\", \"id_select_all\");\n                            label.classList.add(\"d-inline\");\n                            label.innerText = JS.str.selectall;\n\n                            node = document.createElement(\"DIV\");\n                            node.classList.add(\"bg-secondary\");\n                            if (i == 0) {\n                                node.classList.add(\"border-top\");\n                            }\n                            node.classList.add(\"border-bottom\");\n                            node.classList.add(\"border-dark\");\n                            node.classList.add(\"w-100\"); // width: 100%\n                            node.classList.add(\"py-1\");\n                            node.classList.add(\"text-right\");\n                            node.style.paddingRight = \"35px\";\n                            node.classList.add(\"itemselect\");\n\n                            node.appendChild(label);\n                            node.appendChild(input);\n\n                            div.appendChild(node);\n                        } else {\n                            elm.classList.remove(\"col-md-9\");\n                            elm.classList.add(\"col-md-8\");\n\n                            div.classList.add(\"d-none\");\n                            div.classList.add(\"d-md-block\");\n                            div.classList.add(\"col-md-1\");\n                            div.classList.add(\"bg-secondary\");\n                            if (i == 0) {\n                                div.classList.add(\"border-top\");\n                            }\n                            div.classList.add(\"border-bottom\");\n                            div.classList.add(\"border-dark\");\n                            div.classList.add(\"text-center\");\n                            div.classList.add(\"itemselect\");\n\n                            node = document.createElement(\"INPUT\");\n                            if (name == \"mycourses\") {\n                                // Create button to \"Apply\" settings.\n                                node.setAttribute(\"type\", \"submit\");\n                                node.setAttribute(\"value\", JS.str.apply);\n                                node.classList.add(\"btn\");\n                                node.classList.add(\"btn-primary\");\n                                node.classList.add(\"my-1\");\n                                node.classList.add(\"px-2\");\n                            } else {\n                                // Create checkbox for this setting.\n                                node.setAttribute(\"type\", \"checkbox\");\n                                node.setAttribute(\"name\", \"select_\" + name);\n                                node.setAttribute(\"id\", \"id_select_\" + name);\n                                node.classList.add(\"mt-2\");\n                            }\n\n                            div.appendChild(node);\n                        }\n\n                        elm.parentNode.insertBefore(div, elm.nextSibling);\n                    });\n                });\n            }\n        });\n    };\n\n    JS.onchange_selectall = function(){\n        var checked = this.checked;\n        var label = this.parentNode.querySelector(\"label\");\n        if (label) {\n            label.innerText = (checked ? JS.str.deselectall : JS.str.selectall);\n        }\n        var s = \".itemselect input[type=checkbox]:not([name=\" + this.name + \"])\";\n        document.querySelectorAll(s).forEach(function(checkbox){\n            checkbox.checked = checked;\n        });\n    };\n\n    return JS;\n});"],"file":"form.min.js"}